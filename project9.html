import React, { useState, useEffect } from 'react';
import { Send, CheckCircle, Clock, AlertCircle, LogOut, Users, MessageSquare, Trash2, CheckSquare, Lock, UserPlus, ThumbsUp, Star, TrendingUp, Zap } from 'lucide-react';

const fontLink = document.createElement('link');
fontLink.href = 'https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&family=Cairo:wght@400;600;700;800&display=swap';
fontLink.rel = 'stylesheet';
document.head.appendChild(fontLink);

export default function SuggestionsSystem() {
  const [userType, setUserType] = useState(null);
  const [activeView, setActiveView] = useState('submit');
  const [showAdminLogin, setShowAdminLogin] = useState(false);
  const [showRegister, setShowRegister] = useState(false);
  const [showStudentRegister, setShowStudentRegister] = useState(false);
  const [loginData, setLoginData] = useState({ username: '', password: '' });
  const [registerData, setRegisterData] = useState({ username: '', password: '', confirmPassword: '', fullName: '' });
  const [studentRegisterData, setStudentRegisterData] = useState({ username: '', password: '', confirmPassword: '', fullName: '', nationalId: '' });
  const [adminUsers, setAdminUsers] = useState([]);
  const [studentUsers, setStudentUsers] = useState([]);
  const [currentUser, setCurrentUser] = useState(null);
  const [formData, setFormData] = useState({ studentName: '', nationalId: '', email: '', category: '', title: '', description: '' });
  const [suggestions, setSuggestions] = useState([
    { id: 1, studentName: 'ุฃุญูุฏ ูุญูุฏ', studentId: '1234567890', title: '๐ ุชุญุณูู ุฎุฏูุฉ ุงููุงู ูุงู', category: '๐ป ุชูููุฉ', status: 'ููุฏ ุงููุฑุงุฌุนุฉ', date: '2025-10-25', description: 'ููุชุฑุญ ุชุญุณูู ุชุบุทูุฉ ุงููุงู ูุงู ูู ุฌููุน ุฃูุญุงุก ุงููุฏุฑุณุฉ', votes: 45, voters: [] },
    { id: 2, studentName: 'ูุงุทูุฉ ุนูู', studentId: '0987654321', title: '๐ ุฅุถุงูุฉ ููุงุนุฏ ูู ุงูููุชุจุฉ', category: '๐ซ ูุฑุงูู', status: 'ููุชูู', date: '2025-10-20', description: 'ุงูููุชุจุฉ ุชุญุชุงุฌ ุงููุฒูุฏ ูู ุงูููุงุนุฏ ุงููุฑูุญุฉ ููุทูุงุจ', votes: 78, voters: [] }
  ]);
  const [submitted, setSubmitted] = useState(false);
  const [selectedSuggestion, setSelectedSuggestion] = useState(null);

  const categories = [
    '๐ป ุชูููุฉ ูุจููุฉ ุชุญุชูุฉ',
    '๐ซ ูุฑุงูู ูุฎุฏูุงุช',
    '๐ ุฃูุงุฏููู',
    '๐จ ุฃูุดุทุฉ ุทูุงุจูุฉ',
    '๐ก ุฃุฎุฑู'
  ];

  useEffect(() => {
    const savedAdmins = JSON.parse(localStorage.getItem('adminUsers') || '[]');
    const savedStudents = JSON.parse(localStorage.getItem('studentUsers') || '[]');
    if (savedAdmins.length === 0) {
      const def = { username: 'admin', password: 'admin123', fullName: '๐จโ๐ผ ุงููุฏูุฑ ุงูุนุงู' };
      setAdminUsers([def]);
      localStorage.setItem('adminUsers', JSON.stringify([def]));
    } else {
      setAdminUsers(savedAdmins);
    }
    setStudentUsers(savedStudents);
  }, []);

  const handleLogin = (type) => {
    if (type === 'admin') {
      setShowAdminLogin(true);
    } else {
      setShowStudentRegister(true);
    }
  };

  const handleAdminLogin = () => {
    const admin = adminUsers.find(u => u.username === loginData.username && u.password === loginData.password);
    if (admin) {
      setUserType('admin');
      setCurrentUser(admin);
      setActiveView('manage');
      setShowAdminLogin(false);
      setLoginData({ username: '', password: '' });
    } else {
      alert('โ ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ');
    }
  };

  const handleStudentLogin = () => {
    const student = studentUsers.find(u => u.username === studentRegisterData.username && u.password === studentRegisterData.password);
    if (student) {
      setUserType('student');
      setCurrentUser(student);
      setActiveView('submit');
      setShowStudentRegister(false);
      setStudentRegisterData({ username: '', password: '', confirmPassword: '', fullName: '', nationalId: '' });
    } else {
      alert('โ ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ');
    }
  };

  const handleAdminRegister = () => {
    if (!registerData.username || !registerData.password || !registerData.fullName || registerData.password !== registerData.confirmPassword) {
      alert('โ๏ธ ุงูุฑุฌุงุก ุงูุชุญูู ูู ุงูุจูุงูุงุช');
      return;
    }
    if (adminUsers.find(u => u.username === registerData.username)) {
      alert('โ๏ธ ุงุณู ุงููุณุชุฎุฏู ููุฌูุฏ ูุณุจูุงู');
      return;
    }
    const updated = [...adminUsers, { username: registerData.username, password: registerData.password, fullName: registerData.fullName }];
    setAdminUsers(updated);
    localStorage.setItem('adminUsers', JSON.stringify(updated));
    alert('โ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ!');
    setShowRegister(false);
    setRegisterData({ username: '', password: '', confirmPassword: '', fullName: '' });
  };

  const handleStudentRegister = () => {
    if (!studentRegisterData.username || !studentRegisterData.password || !studentRegisterData.fullName || !studentRegisterData.nationalId) {
      alert('โ๏ธ ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุฌููุน ุงูุญููู');
      return;
    }
    if (studentRegisterData.password !== studentRegisterData.confirmPassword) {
      alert('โ๏ธ ูููุงุช ุงููุฑูุฑ ุบูุฑ ูุชุทุงุจูุฉ');
      return;
    }
    if (studentUsers.find(u => u.username === studentRegisterData.username)) {
      alert('โ๏ธ ุงุณู ุงููุณุชุฎุฏู ููุฌูุฏ ูุณุจูุงู');
      return;
    }
    const newStudent = { 
      username: studentRegisterData.username, 
      password: studentRegisterData.password, 
      fullName: studentRegisterData.fullName,
      nationalId: studentRegisterData.nationalId 
    };
    const updated = [...studentUsers, newStudent];
    setStudentUsers(updated);
    localStorage.setItem('studentUsers', JSON.stringify(updated));
    setUserType('student');
    setCurrentUser(newStudent);
    setActiveView('submit');
    setShowStudentRegister(false);
    setStudentRegisterData({ username: '', password: '', confirmPassword: '', fullName: '', nationalId: '' });
  };

  const handleVote = (suggestionId) => {
    if (!currentUser) return;
    setSuggestions(suggestions.map(s => {
      if (s.id === suggestionId) {
        const hasVoted = s.voters?.includes(currentUser.username);
        if (hasVoted) {
          return { ...s, votes: s.votes - 1, voters: s.voters.filter(v => v !== currentUser.username) };
        } else {
          return { ...s, votes: s.votes + 1, voters: [...(s.voters || []), currentUser.username] };
        }
      }
      return s;
    }));
  };

  const handleSubmit = () => {
    if (!formData.title || !formData.category || !formData.description) {
      alert('โ๏ธ ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ');
      return;
    }
    setSubmitted(true);
    setSuggestions([{ 
      id: suggestions.length + 1, 
      studentName: currentUser.fullName, 
      studentId: currentUser.nationalId, 
      title: formData.title, 
      category: formData.category, 
      status: 'ุฌุฏูุฏ', 
      date: new Date().toISOString().split('T')[0], 
      description: formData.description, 
      votes: 0,
      voters: []
    }, ...suggestions]);
    setTimeout(() => {
      setSubmitted(false);
      setFormData({ studentName: '', nationalId: '', email: '', category: '', title: '', description: '' });
    }, 3000);
  };

  const stats = { 
    total: suggestions.length, 
    new: suggestions.filter(s => s.status === 'ุฌุฏูุฏ').length, 
    inProgress: suggestions.filter(s => s.status === 'ููุฏ ุงููุฑุงุฌุนุฉ').length, 
    completed: suggestions.filter(s => s.status === 'ููุชูู').length 
  };

  if (showAdminLogin) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-green-50 flex items-center justify-center p-4" dir="rtl" style={{ fontFamily: "'Tajawal', 'Cairo', sans-serif" }}>
        <div className="max-w-md w-full bg-white rounded-3xl shadow-2xl p-6 sm:p-8 border-4 border-blue-300 relative overflow-hidden">
          <div className="absolute top-0 left-0 w-40 h-40 bg-blue-200 rounded-full -translate-x-20 -translate-y-20 opacity-50"></div>
          <div className="absolute bottom-0 right-0 w-40 h-40 bg-green-200 rounded-full translate-x-20 translate-y-20 opacity-50"></div>
          <div className="relative z-10">
            <div className="text-center mb-6 sm:mb-8">
              <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-600 to-green-600 rounded-full mb-4 shadow-xl">
                <Lock className="w-10 h-10 text-white" />
              </div>
              <h2 className="text-3xl font-bold text-blue-800 mb-2">๐ ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ</h2>
              <p className="text-blue-700">๐ซ ูุดูุงุฉ ุงูููุงุฑ ุงูุฃูููุฉ</p>
            </div>
            <div className="space-y-4 mb-6">
              <input type="text" value={loginData.username} onChange={(e) => setLoginData({ ...loginData, username: e.target.value })} className="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 rounded-xl focus:outline-none focus:border-blue-600 text-blue-900" placeholder="๐ค ุงุณู ุงููุณุชุฎุฏู" />
              <input type="password" value={loginData.password} onChange={(e) => setLoginData({ ...loginData, password: e.target.value })} className="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 rounded-xl focus:outline-none focus:border-blue-600 text-blue-900" placeholder="๐ ูููุฉ ุงููุฑูุฑ" />
            </div>
            <div className="bg-gradient-to-r from-cyan-50 to-blue-50 border-2 border-cyan-300 rounded-xl p-4 mb-6">
              <p className="text-sm text-cyan-800 font-semibold">๐ก ุงูุญุณุงุจ ุงูุงูุชุฑุงุถู: admin / admin123</p>
            </div>
            <div className="space-y-3">
              <button onClick={handleAdminLogin} className="w-full bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white font-bold py-3 rounded-xl shadow-lg flex items-center justify-center gap-2 transform hover:scale-105 transition-all">
                <Lock className="w-5 h-5" />โจ ุฏุฎูู
              </button>
              <button onClick={() => setShowRegister(true)} className="w-full bg-gradient-to-r from-green-100 to-blue-100 hover:from-green-200 hover:to-blue-200 text-green-800 font-bold py-3 rounded-xl flex items-center justify-center gap-2 transform hover:scale-105 transition-all">
                <UserPlus className="w-5 h-5" />โ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ
              </button>
              <button onClick={() => setShowAdminLogin(false)} className="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 rounded-xl transition-all">โฌ๏ธ ุฑุฌูุน</button>
            </div>
          </div>
        </div>
      </div>
    );
  }

  if (showRegister) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-green-50 flex items-center justify-center p-4" dir="rtl" style={{ fontFamily: "'Tajawal', 'Cairo', sans-serif" }}>
        <div className="max-w-md w-full bg-white rounded-3xl shadow-2xl p-6 sm:p-8 border-4 border-green-300">
          <div className="text-center mb-8">
            <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-green-600 to-blue-600 rounded-full mb-4 shadow-xl">
              <UserPlus className="w-10 h-10 text-white" />
            </div>
            <h2 className="text-3xl font-bold text-green-800 mb-2">๐จโ๐ผ ุฅูุดุงุก ุญุณุงุจ ุฅุฏุงุฑุฉ</h2>
            <p className="text-green-700">๐ซ ูุดูุงุฉ ุงูููุงุฑ ุงูุฃูููุฉ</p>
          </div>
          <div className="space-y-4 mb-6">
            <input type="text" value={registerData.fullName} onChange={(e) => setRegisterData({ ...registerData, fullName: e.target.value })} className="w-full px-4 py-3 bg-green-50 border-2 border-green-300 rounded-xl focus:outline-none focus:border-green-600 text-green-900" placeholder="๐ ุงูุงุณู ุงููุงูู" />
            <input type="text" value={registerData.username} onChange={(e) => setRegisterData({ ...registerData, username: e.target.value })} className="w-full px-4 py-3 bg-green-50 border-2 border-green-300 rounded-xl focus:outline-none focus:border-green-600 text-green-900" placeholder="๐ค ุงุณู ุงููุณุชุฎุฏู" />
            <input type="password" value={registerData.password} onChange={(e) => setRegisterData({ ...registerData, password: e.target.value })} className="w-full px-4 py-3 bg-green-50 border-2 border-green-300 rounded-xl focus:outline-none focus:border-green-600 text-green-900" placeholder="๐ ูููุฉ ุงููุฑูุฑ" />
            <input type="password" value={registerData.confirmPassword} onChange={(e) => setRegisterData({ ...registerData, confirmPassword: e.target.value })} className="w-full px-4 py-3 bg-green-50 border-2 border-green-300 rounded-xl focus:outline-none focus:border-green-600 text-green-900" placeholder="โ ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ" />
          </div>
          <div className="space-y-3">
            <button onClick={handleAdminRegister} className="w-full bg-gradient-to-r from-green-600 to-blue-600 text-white font-bold py-3 rounded-xl shadow-lg flex items-center justify-center gap-2 transform hover:scale-105 transition-all">
              <UserPlus className="w-5 h-5" />๐ ุฅูุดุงุก ุงูุญุณุงุจ
            </button>
            <button onClick={() => setShowRegister(false)} className="w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl">โฌ๏ธ ุฑุฌูุน</button>
          </div>
        </div>
      </div>
    );
  }

  if (showStudentRegister) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-green-50 flex items-center justify-center p-4" dir="rtl" style={{ fontFamily: "'Tajawal', 'Cairo', sans-serif" }}>
        <div className="max-w-md w-full bg-white rounded-3xl shadow-2xl p-6 sm:p-8 border-4 border-cyan-300">
          <div className="text-center mb-8">
            <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full mb-4 shadow-xl animate-pulse">
              <Users className="w-10 h-10 text-white" />
            </div>
            <h2 className="text-3xl font-bold text-cyan-800 mb-2">๐ ุญุณุงุจ ุงูุทุงูุจ</h2>
            <p className="text-cyan-700">๐ ูุดูุงุฉ ุงูููุงุฑ ุงูุฃูููุฉ</p>
          </div>
          
          <div className="flex gap-3 mb-6">
            <button onClick={() => setActiveView('login')} className={`flex-1 py-2 rounded-xl font-bold transition-all ${activeView === 'login' ? 'bg-gradient-to-r from-cyan-600 to-blue-600 text-white' : 'bg-cyan-100 text-cyan-700'}`}>
              ๐ ุชุณุฌูู ุฏุฎูู
            </button>
            <button onClick={() => setActiveView('register')} className={`flex-1 py-2 rounded-xl font-bold transition-all ${activeView === 'register' ? 'bg-gradient-to-r from-cyan-600 to-blue-600 text-white' : 'bg-cyan-100 text-cyan-700'}`}>
              โ ุญุณุงุจ ุฌุฏูุฏ
            </button>
          </div>

          {activeView === 'login' ? (
            <div className="space-y-4 mb-6">
              <input type="text" value={studentRegisterData.username} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, username: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="๐ค ุงุณู ุงููุณุชุฎุฏู" />
              <input type="password" value={studentRegisterData.password} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, password: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="๐ ูููุฉ ุงููุฑูุฑ" />
              <button onClick={handleStudentLogin} className="w-full bg-gradient-to-r from-cyan-600 to-blue-600 text-white font-bold py-3 rounded-xl shadow-lg flex items-center justify-center gap-2 transform hover:scale-105 transition-all">
                <Lock className="w-5 h-5" />โจ ุฏุฎูู
              </button>
            </div>
          ) : (
            <div className="space-y-4 mb-6">
              <input type="text" value={studentRegisterData.fullName} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, fullName: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="๐ ุงูุงุณู ุงููุงูู" />
              <input type="text" value={studentRegisterData.nationalId} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, nationalId: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="๐ ุฑูู ุงููููุฉ" />
              <input type="text" value={studentRegisterData.username} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, username: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="๐ค ุงุณู ุงููุณุชุฎุฏู" />
              <input type="password" value={studentRegisterData.password} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, password: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="๐ ูููุฉ ุงููุฑูุฑ" />
              <input type="password" value={studentRegisterData.confirmPassword} onChange={(e) => setStudentRegisterData({ ...studentRegisterData, confirmPassword: e.target.value })} className="w-full px-4 py-3 bg-cyan-50 border-2 border-cyan-300 rounded-xl focus:outline-none focus:border-cyan-600 text-cyan-900" placeholder="โ ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ" />
              <button onClick={handleStudentRegister} className="w-full bg-gradient-to-r from-cyan-600 to-blue-600 text-white font-bold py-3 rounded-xl shadow-lg flex items-center justify-center gap-2 transform hover:scale-105 transition-all">
                <UserPlus className="w-5 h-5" />๐ ุฅูุดุงุก ุงูุญุณุงุจ
              </button>
            </div>
          )}
          
          <button onClick={() => setShowStudentRegister(false)} className="w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl">โฌ๏ธ ุฑุฌูุน</button>
        </div>
      </div>
    );
  }

  if (!userType) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-green-50 flex items-center justify-center p-4 relative overflow-hidden" dir="rtl" style={{ fontFamily: "'Tajawal', 'Cairo', sans-serif" }}>
        <div className="absolute top-10 left-10 text-6xl animate-bounce">โญ</div>
        <div className="absolute top-20 right-20 text-4xl animate-pulse">โจ</div>
        <div className="absolute bottom-20 left-20 text-5xl animate-spin" style={{ animationDuration: '10s' }}>๐ฏ</div>
        <div className="absolute bottom-10 right-10 text-4xl animate-bounce delay-500">๐ก</div>
        
        <div className="max-w-6xl w-full relative z-10">
          <div className="text-center mb-12">
            <div className="inline-block mb-6 animate-bounce">
              <div className="text-8xl">๐</div>
            </div>
            <h1 className="text-4xl sm:text-5xl lg:text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-cyan-600 to-green-600 mb-4 animate-pulse">
              ูุธุงู ุงูุงูุชุฑุงุญุงุช ุงูุทูุงุจูุฉ
            </h1>
            <p className="text-xl sm:text-2xl text-blue-700 font-semibold">๐ซ ูุดูุงุฉ ุงูููุงุฑ ุงูุฃูููุฉ</p>
            <p className="text-lg text-green-600 mt-2">โจ ุตูุชู ูุตู ูุจุงุดุฑุฉ ููุฅุฏุงุฑุฉ</p>
          </div>
          
          <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div onClick={() => handleLogin('student')} className="group bg-white rounded-3xl shadow-2xl p-10 border-4 border-cyan-300 hover:border-cyan-500 cursor-pointer transform hover:scale-105 transition-all duration-300 hover:shadow-cyan-300">
              <div className="text-center">
                <div className="inline-flex items-center justify-center w-28 h-28 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full mb-6 group-hover:scale-110 transition-transform shadow-xl">
                  <Users className="w-14 h-14 text-white" />
                </div>
                <h2 className="text-4xl font-bold text-cyan-800 mb-4">๐ ุฏุฎูู ุงูุทูุงุจ</h2>
                <p className="text-blue-700 text-lg mb-6">ุดุงุฑู ุฃููุงุฑู ุงูุฅุจุฏุงุนูุฉ ูุงูุชุฑุงุญุงุชู ูุชุทููุฑ ุงููุฏุฑุณุฉ ๐ก</p>
                <div className="bg-gradient-to-r from-cyan-100 to-blue-100 rounded-xl p-4 text-cyan-800 group-hover:from-cyan-200 group-hover:to-blue-200 transition-all">
                  <p className="font-bold text-lg">๐ ุงุถุบุท ููุฏุฎูู</p>
                </div>
              </div>
            </div>
            
            <div onClick={() => handleLogin('admin')} className="group bg-white rounded-3xl shadow-2xl p-10 border-4 border-green-300 hover:border-green-500 cursor-pointer transform hover:scale-105 transition-all duration-300 hover:shadow-green-300">
              <div className="text-center">
                <div className="inline-flex items-center justify-center w-28 h-28 bg-gradient-to-br from-green-600 to-blue-700 rounded-full mb-6 group-hover:scale-110 transition-transform shadow-xl">
                  <CheckSquare className="w-14 h-14 text-white" />
                </div>
                <h2 className="text-4xl font-bold text-green-800 mb-4">๐จโ๐ผ ุฏุฎูู ุงูุฅุฏุงุฑุฉ</h2>
                <p className="text-blue-700 text-lg mb-6">ุฅุฏุงุฑุฉ ููุชุงุจุนุฉ ุงูุชุฑุงุญุงุช ุงูุทูุงุจ ุจููุงุกุฉ ุนุงููุฉ ๐</p>
                <div className="bg-gradient-to-r from-green-100 to-blue-100 rounded-xl p-4 text-green-800 group-hover:from-green-200 group-hover:to-blue-200 transition-all">
                  <p className="font-bold text-lg">๐ ุงุถุบุท ููุฏุฎูู</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-green-50" dir="rtl" style={{ fontFamily: "'Tajawal', 'Cairo', sans-serif" }}>
      <header className="bg-white border-b-4 border-gradient-to-r from-blue-500 to-green-500 shadow-xl sticky top-0 z-50">
        <div className="container mx-auto px-4 py-4 flex flex-col sm:flex-row items-center justify-between gap-3">
          <div className="text-center sm:text-right">
            <h1 className="text-2xl font-bold bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">
              โจ ูุธุงู ุงูุงูุชุฑุงุญุงุช
            </h1>
            <p className="text-sm text-cyan-600 font-semibold">
              {userType === 'admin' ? `๐จโ๐ผ ${currentUser?.fullName}` : `๐ ${currentUser?.fullName}`}
            </p>
          </div>
          
          <div className="flex items-center gap-2 sm:gap-4 w-full sm:w-auto">
            {userType === 'student' && (
              <div className="flex gap-2 flex-1 sm:flex-initial">
                <button onClick={() => setActiveView('submit')} className={`flex-1 px-4 py-2.5 rounded-xl font-bold text-sm transition-all ${activeView === 'submit' ? 'bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-lg' : 'bg-blue-100 text-blue-800'}`}>
                  ๐ ุฅุฑุณุงู ุงูุชุฑุงุญ
                </button>
                <button onClick={() => setActiveView('track')} className={`flex-1 px-4 py-2.5 rounded-xl font-bold text-sm transition-all ${activeView === 'track' ? 'bg-gradient-to-r from-green-600 to-cyan-600 text-white shadow-lg' : 'bg-green-100 text-green-800'}`}>
                  ๐ ุชุชุจุน ุงูุงูุชุฑุงุญุงุช
                </button>
              </div>
            )}
            <button onClick={() => { setUserType(null); setCurrentUser(null); }} className="flex items-center gap-2 px-4 py-2.5 bg-red-100 text-red-700 rounded-xl font-bold hover:bg-red-200 transition-all">
              <LogOut className="w-4 h-4" />๐ช ุฎุฑูุฌ
            </button>
          </div>
        </div>
      </header>

      <main className="container mx-auto px-4 py-8">
        {userType === 'admin' && (
          <div>
            <div className="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
              <div className="bg-white rounded-2xl shadow-xl p-6 border-l-4 border-blue-600 hover:scale-105 transition-all">
                <div className="flex items-center justify-between mb-2">
                  <p className="text-blue-700 text-sm font-bold">๐ ุฅุฌูุงูู</p>
                  <MessageSquare className="w-8 h-8 text-blue-600" />
                </div>
                <p className="text-4xl font-bold text-blue-800">{stats.total}</p>
                <p className="text-xs text-blue-600 mt-1">ุงูุชุฑุงุญ</p>
              </div>
              <div className="bg-white rounded-2xl shadow-xl p-6 border-l-4 border-cyan-600 hover:scale-105 transition-all">
                <div className="flex items-center justify-between mb-2">
                  <p className="text-cyan-700 text-sm font-bold">๐ ุฌุฏูุฏุฉ</p>
                  <AlertCircle className="w-8 h-8 text-cyan-600" />
                </div>
                <p className="text-4xl font-bold text-cyan-800">{stats.new}</p>
                <p className="text-xs text-cyan-600 mt-1">ุงูุชุฑุงุญ</p>
              </div>
              <div className="bg-white rounded-2xl shadow-xl p-6 border-l-4 border-yellow-600 hover:scale-105 transition-all">
                <div className="flex items-center justify-between mb-2">
                  <p className="text-yellow-700 text-sm font-bold">โณ ุฌุงุฑู</p>
                  <Clock className="w-8 h-8 text-yellow-600" />
                </div>
                <p className="text-4xl font-bold text-yellow-800">{stats.inProgress}</p>
                <p className="text-xs text-yellow-600 mt-1">ุงูุชุฑุงุญ</p>
              </div>
              <div className="bg-white rounded-2xl shadow-xl p-6 border-l-4 border-green-600 hover:scale-105 transition-all">
                <div className="flex items-center justify-between mb-2">
                  <p className="text-green-700 text-sm font-bold">โ ููุชููุฉ</p>
                  <CheckCircle className="w-8 h-8 text-green-600" />
                </div>
                <p className="text-4xl font-bold text-green-800">{stats.completed}</p>
                <p className="text-xs text-green-600 mt-1">ุงูุชุฑุงุญ</p>
              </div>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <div className="lg:col-span-2 bg-white rounded-3xl shadow-2xl p-8 border-4 border-blue-200">
                <h2 className="text-3xl font-bold text-blue-800 mb-6">๐ ูุงุฆูุฉ ุงูุงูุชุฑุงุญุงุช</h2>
                <div className="space-y-4">
                  {suggestions.map((s) => (
                    <div key={s.id} onClick={() => setSelectedSuggestion(s)} className={`bg-gradient-to-r from-blue-50 to-cyan-50 border-2 rounded-2xl p-6 cursor-pointer transition-all hover:shadow-lg ${selectedSuggestion?.id === s.id ? 'border-blue-600 shadow-xl scale-105' : 'border-blue-200'}`}>
                      <div className="flex items-start justify-between mb-3">
                        <h3 className="text-xl font-bold text-blue-800 flex-1">{s.title}</h3>
                        <div className="flex items-center gap-2 bg-white px-3 py-1 rounded-full">
                          <ThumbsUp className="w-4 h-4 text-green-600" />
                          <span className="font-bold text-green-600">{s.votes}</span>
                        </div>
                      </div>
                      <p className="text-green-700 mb-3">{s.description}</p>
                      <div className="flex flex-wrap gap-2 text-sm">
                        <span className="bg-white px-3 py-1 rounded-lg border-2 border-blue-300 font-semibold text-blue-800">{s.category}</span>
                        <span className="bg-white px-3 py-1 rounded-lg text-green-700">๐ค {s.studentName}</span>
                        <span className="bg-white px-3 py-1 rounded-lg text-cyan-700">๐ {s.date}</span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="lg:col-span-1">
                {selectedSuggestion ? (
                  <div className="bg-white rounded-3xl shadow-2xl p-8 border-4 border-green-200 sticky top-24">
                    <h3 className="text-2xl font-bold text-green-800 mb-6">๐ ุชูุงุตูู ุงูุงูุชุฑุงุญ</h3>
                    <div className="space-y-4 mb-6">
                      <div className="bg-gradient-to-r from-blue-50 to-cyan-50 p-4 rounded-xl">
                        <p className="text-sm font-bold text-blue-700 mb-1">๐ ุงูุนููุงู</p>
                        <p className="text-blue-900 font-semibold">{selectedSuggestion.title}</p>
                      </div>
                      <div className="bg-gradient-to-r from-green-50 to-cyan-50 p-4 rounded-xl">
                        <p className="text-sm font-bold text-green-700 mb-1">๐ค ุงูุทุงูุจ</p>
                        <p className="text-green-900">{selectedSuggestion.studentName}</p>
                      </div>
                      <div className="bg-gradient-to-r from-cyan-50 to-blue-50 p-4 rounded-xl">
                        <p className="text-sm font-bold text-cyan-700 mb-1">๐ ุงูุชุตููุช</p>
                        <p className="text-cyan-900 text-2xl font-bold">{selectedSuggestion.votes} ุตูุช</p>
                      </div>
                    </div>
                    <div className="space-y-2 mb-6">
                      <p className="text-sm font-bold text-gray-700 mb-2">๐ ุชุญุฏูุซ ุงูุญุงูุฉ</p>
                      <button onClick={() => setSuggestions(suggestions.map(s => s.id === selectedSuggestion.id ? { ...s, status: 'ุฌุฏูุฏ' } : s))} className="w-full px-4 py-3 rounded-xl font-bold bg-gradient-to-r from-cyan-100 to-blue-100 text-cyan-700 hover:from-cyan-200 hover:to-blue-200 transition-all">๐ ุฌุฏูุฏ</button>
                      <button onClick={() => setSuggestions(suggestions.map(s => s.id === selectedSuggestion.id ? { ...s, status: 'ููุฏ ุงููุฑุงุฌุนุฉ' } : s))} className="w-full px-4 py-3 rounded-xl font-bold bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-700 hover:from-yellow-200 hover:to-orange-200 transition-all">โณ ููุฏ ุงููุฑุงุฌุนุฉ</button>
                      <button onClick={() => setSuggestions(suggestions.map(s => s.id === selectedSuggestion.id ? { ...s, status: 'ููุชูู' } : s))} className="w-full px-4 py-3 rounded-xl font-bold bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 hover:from-green-200 hover:to-emerald-200 transition-all">โ ููุชูู</button>
                    </div>
                    <button onClick={() => { setSuggestions(suggestions.filter(s => s.id !== selectedSuggestion.id)); setSelectedSuggestion(null); }} className="w-full bg-gradient-to-r from-red-100 to-pink-100 text-red-700 font-bold py-3 rounded-xl flex items-center justify-center gap-2 hover:from-red-200 hover:to-pink-200 transition-all">
                      <Trash2 className="w-5 h-5" />๐๏ธ ุญุฐู ุงูุงูุชุฑุงุญ
                    </button>
                  </div>
                ) : (
                  <div className="bg-white rounded-3xl shadow-2xl p-8 border-4 border-blue-200 text-center sticky top-24">
                    <div className="text-6xl mb-4">๐</div>
                    <p className="text-blue-700 text-lg font-semibold">ุงุฎุชุฑ ุงูุชุฑุงุญุงู ูุนุฑุถ ุงูุชูุงุตูู</p>
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {userType === 'student' && activeView === 'submit' && (
          <div className="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl p-8 border-4 border-blue-200">
            <div className="text-center mb-8">
              <div className="text-6xl mb-4">๐ก</div>
              <h2 className="text-4xl font-bold bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent mb-2">ุดุงุฑู ุงูุชุฑุงุญู ุงูุฅุจุฏุงุนู</h2>
              <p className="text-blue-700">โจ ูุญู ูุณุชูุน ูุฃููุงุฑู ููุนูู ุนูู ุชุญุณูู ุชุฌุฑุจุชู ุงูุฏุฑุงุณูุฉ</p>
            </div>

            {submitted ? (
              <div className="text-center py-12">
                <div className="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full mb-6 animate-bounce">
                  <CheckCircle className="w-12 h-12 text-white" />
                </div>
                <div className="text-6xl mb-4">๐</div>
                <h3 className="text-3xl font-bold text-green-800 mb-4">ุชู ุฅุฑุณุงู ุงูุชุฑุงุญู ุจูุฌุงุญ!</h3>
                <p className="text-blue-700 text-lg">โฐ ุณูุชู ูุฑุงุฌุนุชู ูู ูุจู ุงูุฅุฏุงุฑุฉ ูุฑูุจุงู</p>
              </div>
            ) : (
              <div className="space-y-6">
                <div>
                  <label className="block text-lg font-bold text-blue-800 mb-2">๐ ุชุตููู ุงูุงูุชุฑุงุญ</label>
                  <select name="category" value={formData.category} onChange={(e) => setFormData({ ...formData, [e.target.name]: e.target.value })} className="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 rounded-xl focus:outline-none focus:border-blue-600 text-blue-900 text-lg">
                    <option value="">ุงุฎุชุฑ ุงูุชุตููู</option>
                    {categories.map((c, i) => <option key={i} value={c}>{c}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-lg font-bold text-blue-800 mb-2">๐ ุนููุงู ุงูุงูุชุฑุงุญ</label>
                  <input type="text" name="title" value={formData.title} onChange={(e) => setFormData({ ...formData, [e.target.name]: e.target.value })} className="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 rounded-xl focus:outline-none focus:border-blue-600 text-blue-900 text-lg" placeholder="ุนููุงู ูุงุถุญ ููุฎุชุตุฑ" />
                </div>
                <div>
                  <label className="block text-lg font-bold text-blue-800 mb-2">๐ญ ุชูุงุตูู ุงูุงูุชุฑุงุญ</label>
                  <textarea name="description" value={formData.description} onChange={(e) => setFormData({ ...formData, [e.target.name]: e.target.value })} rows="6" className="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 rounded-xl focus:outline-none focus:border-blue-600 text-blue-900 resize-none text-lg" placeholder="ุงุดุฑุญ ุงูุชุฑุงุญู ุจุงูุชูุตูู..."></textarea>
                </div>
                <button onClick={handleSubmit} className="w-full bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white font-bold py-4 rounded-xl shadow-lg flex items-center justify-center gap-3 text-xl transform hover:scale-105 transition-all">
                  <Send className="w-6 h-6" />๐ ุฅุฑุณุงู ุงูุงูุชุฑุงุญ
                </button>
              </div>
            )}
          </div>
        )}

        {userType === 'student' && activeView === 'track' && (
          <div className="max-w-6xl mx-auto bg-white rounded-3xl shadow-2xl p-8 border-4 border-green-200">
            <div className="text-center mb-8">
              <div className="text-6xl mb-4">๐</div>
              <h2 className="text-4xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent mb-2">ุงูุงูุชุฑุงุญุงุช ุงูุญุงููุฉ</h2>
              <p className="text-green-700">๐ ุชุงุจุน ุญุงูุฉ ุฌููุน ุงูุงูุชุฑุงุญุงุช</p>
            </div>
            <div className="space-y-4">
              {suggestions.map((s) => (
                <div key={s.id} className="bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 rounded-2xl p-6 hover:border-green-400 hover:shadow-xl transition-all">
                  <div className="flex items-start justify-between mb-3">
                    <h3 className="text-xl font-bold text-green-800 flex-1">{s.title}</h3>
                    <button onClick={() => handleVote(s.id)} className={`flex items-center gap-2 px-4 py-2 rounded-full font-bold transition-all ${s.voters?.includes(currentUser?.username) ? 'bg-gradient-to-r from-green-500 to-emerald-500 text-white' : 'bg-white text-green-700 border-2 border-green-300'}`}>
                      <ThumbsUp className="w-4 h-4" />
                      <span>{s.votes}</span>
                    </button>
                  </div>
                  <p className="text-blue-700 mb-3">{s.description}</p>
                  <div className="flex flex-wrap gap-2 text-sm">
                    <span className="bg-white px-3 py-1 rounded-lg border-2 border-green-300 font-semibold text-green-800">{s.category}</span>
                    <span className={`px-3 py-1 rounded-lg text-white font-semibold ${s.status === 'ุฌุฏูุฏ' ? 'bg-gradient-to-r from-cyan-500 to-blue-500' : s.status === 'ููุฏ ุงููุฑุงุฌุนุฉ' ? 'bg-gradient-to-r from-yellow-500 to-orange-500' : 'bg-gradient-to-r from-green-500 to-emerald-500'}`}>
                      {s.status === 'ุฌุฏูุฏ' ? '๐' : s.status === 'ููุฏ ุงููุฑุงุฌุนุฉ' ? 'โณ' : 'โ'} {s.status}
                    </span>
                    <span className="bg-white px-3 py-1 rounded-lg text-blue-700">๐ {s.date}</span>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}
      </main>

      <footer className="mt-20 border-t-4 border-gradient-to-r from-blue-500 to-green-500 bg-white py-8">
        <div className="container mx-auto px-4 text-center">
          <p className="text-xl font-bold bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent mb-2">๐ซ ูุดูุงุฉ ุงูููุงุฑ ุงูุฃูููุฉ</p>
          <p className="text-blue-700">ยฉ 2025 ุฌููุน ุงูุญููู ูุญููุธุฉ โจ</p>
        </div>
      </footer>
    </div>
  );
}
